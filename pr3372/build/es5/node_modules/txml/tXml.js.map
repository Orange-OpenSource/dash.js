{"version":3,"sources":["../../../../node_modules/txml/tXml.js"],"names":["tXml","S","options","pos","openBracket","openBracketCC","charCodeAt","closeBracket","closeBracketCC","minus","minusCC","slash","slashCC","exclamation","exclamationCC","singleQuote","singleQuoteCC","doubleQuote","doubleQuoteCC","openCornerBracket","openCornerBracketCC","closeCornerBracket","closeCornerBracketCC","parseChildren","children","indexOf","length","substr","toLowerCase","cdataEndIndex","push","substring","node","parseNode","text","parseText","trim","start","slice","nameSpacer","parseName","NoChildNodes","noChildNodes","tagName","attributes","c","name","code","value","parseString","startChar","startpos","findElements","r","RegExp","attrName","attrValue","exec","index","out","undefined","lastIndexOf","filter","setPos","simplify","forEach","child","kids","Object","keys","_attributes","i","simplifyLostLess","parentAttributes","f","dept","path","concat","stringify","O","writeChildren","writeNode","N","toContentString","tDom","Array","isArray","e","getElementById","id","simplified","getElementsByClassName","classname","parseStream","stream","offset","fs","require","createReadStream","position","data","on","chunk","lastPos","res","emit","transformStream","through2","readableObjectMode","enc","callback","module","exports","xml"],"mappings":"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","file":"tXml.js","sourcesContent":["// ==ClosureCompiler==\n// @output_file_name default.js\n// @compilation_level SIMPLE_OPTIMIZATIONS\n// ==/ClosureCompiler==\n\n/**\n * @author: Tobias Nickel\n * @created: 06.04.2015\n * I needed a small xmlparser chat can be used in a worker.\n */\n\n/**\n * @typedef tNode \n * @property {string} tagName \n * @property {object} attributes\n * @property {tNode|string|number[]} children \n **/\n\n/**\n * parseXML / html into a DOM Object. with no validation and some failur tolerance\n * @param {string} S your XML to parse\n * @param options {object} all other options:\n * searchId {string} the id of a single element, that should be returned. using this will increase the speed rapidly\n * filter {function} filter method, as you know it from Array.filter. but is goes throw the DOM.\n\n * @return {tNode[]}\n */\nfunction tXml(S, options) {\n    \"use strict\";\n    options = options || {};\n\n    var pos = options.pos || 0;\n\n    var openBracket = \"<\";\n    var openBracketCC = \"<\".charCodeAt(0);\n    var closeBracket = \">\";\n    var closeBracketCC = \">\".charCodeAt(0);\n    var minus = \"-\";\n    var minusCC = \"-\".charCodeAt(0);\n    var slash = \"/\";\n    var slashCC = \"/\".charCodeAt(0);\n    var exclamation = '!';\n    var exclamationCC = '!'.charCodeAt(0);\n    var singleQuote = \"'\";\n    var singleQuoteCC = \"'\".charCodeAt(0);\n    var doubleQuote = '\"';\n    var doubleQuoteCC = '\"'.charCodeAt(0);\n    var openCornerBracket = '[';\n    var openCornerBracketCC = '['.charCodeAt(0);\n    var closeCornerBracket = ']';\n    var closeCornerBracketCC = ']'.charCodeAt(0);\n    \n\n    /**\n     * parsing a list of entries\n     */\n    function parseChildren() {\n        var children = [];\n        while (S[pos]) {\n            if (S.charCodeAt(pos) == openBracketCC) {\n                if (S.charCodeAt(pos + 1) === slashCC) {\n                    pos = S.indexOf(closeBracket, pos);\n                    if (pos + 1) pos += 1\n                    return children;\n                } else if (S.charCodeAt(pos + 1) === exclamationCC) {\n                    if (S.charCodeAt(pos + 2) == minusCC) {\n                        //comment support\n                        while (pos !== -1 && !(S.charCodeAt(pos) === closeBracketCC && S.charCodeAt(pos - 1) == minusCC && S.charCodeAt(pos - 2) == minusCC && pos != -1)) {\n                            pos = S.indexOf(closeBracket, pos + 1);\n                        }\n                        if (pos === -1) {\n                            pos = S.length\n                        }\n                    }else if(\n                        S.charCodeAt(pos + 2) === openCornerBracketCC\n                        && S.charCodeAt(pos + 8) === openCornerBracketCC\n                        && S.substr(pos+3, 5).toLowerCase() === 'cdata'\n                    ){\n                        // cdata\n                        var cdataEndIndex = S.indexOf(']]>',pos)\n                        if (cdataEndIndex==-1) {\n                            children.push(S.substr(pos+8));\n                            pos=S.length;\n                        } else {\n                            children.push(S.substring(pos+9, cdataEndIndex));\n                            pos = cdataEndIndex + 3;\n                        }\n                        continue\n                    } else {\n                        // doctypesupport\n                        pos += 2;\n                        while (S.charCodeAt(pos) !== closeBracketCC && S[pos]) {\n                            pos++;\n                        }\n                    }\n                    pos++;\n                    continue;\n                }\n                var node = parseNode();\n                children.push(node);\n            } else {\n                var text = parseText()\n                if (text.trim().length > 0)\n                    children.push(text);\n                pos++;\n            }\n        }\n        return children;\n    }\n\n    /**\n     *    returns the text outside of texts until the first '<'\n     */\n    function parseText() {\n        var start = pos;\n        pos = S.indexOf(openBracket, pos) - 1;\n        if (pos === -2)\n            pos = S.length;\n        return S.slice(start, pos + 1);\n    }\n    /**\n     *    returns text until the first nonAlphebetic letter\n     */\n    var nameSpacer = '\\r\\n\\t>/= ';\n\n    function parseName() {\n        var start = pos;\n        while (nameSpacer.indexOf(S[pos]) === -1 && S[pos]) {\n            pos++;\n        }\n        return S.slice(start, pos);\n    }\n    /**\n     *    is parsing a node, including tagName, Attributes and its children,\n     * to parse children it uses the parseChildren again, that makes the parsing recursive\n     */\n    var NoChildNodes = options.noChildNodes || ['img', 'br', 'input', 'meta', 'link'];\n\n    function parseNode() {\n        pos++;\n        const tagName = parseName();\n        const attributes = {};\n        let children = [];\n\n        // parsing attributes\n        while (S.charCodeAt(pos) !== closeBracketCC && S[pos]) {\n            var c = S.charCodeAt(pos);\n            if ((c > 64 && c < 91) || (c > 96 && c < 123)) {\n                //if('abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ'.indexOf(S[pos])!==-1 ){\n                var name = parseName();\n                // search beginning of the string\n                var code = S.charCodeAt(pos);\n                while (code && code !== singleQuoteCC && code !== doubleQuoteCC && !((code > 64 && code < 91) || (code > 96 && code < 123)) && code !== closeBracketCC) {\n                    pos++;\n                    code = S.charCodeAt(pos);\n                }\n                if (code === singleQuoteCC || code === doubleQuoteCC) {\n                    var value = parseString();\n                    if (pos === -1) {\n                        return {\n                            tagName,\n                            attributes,\n                            children,\n                        };\n                    }\n                } else {\n                    value = null;\n                    pos--;\n                }\n                attributes[name] = value;\n            }\n            pos++;\n        }\n        // optional parsing of children\n        if (S.charCodeAt(pos - 1) !== slashCC) {\n            if (tagName == \"script\") {\n                var start = pos + 1;\n                pos = S.indexOf('</script>', pos);\n                children = [S.slice(start, pos)];\n                pos += 9;\n            } else if (tagName == \"style\") {\n                var start = pos + 1;\n                pos = S.indexOf('</style>', pos);\n                children = [S.slice(start, pos)];\n                pos += 8;\n            } else if (NoChildNodes.indexOf(tagName) == -1) {\n                pos++;\n                children = parseChildren(name);\n            }\n        } else {\n            pos++;\n        }\n        return {\n            tagName,\n            attributes,\n            children,\n        };\n    }\n\n    /**\n     *    is parsing a string, that starts with a char and with the same usually  ' or \"\n     */\n\n    function parseString() {\n        var startChar = S[pos];\n        var startpos = pos+1;\n        pos = S.indexOf(startChar, startpos)\n        return S.slice(startpos, pos);\n    }\n\n    /**\n     *\n     */\n    function findElements() {\n        var r = new RegExp('\\\\s' + options.attrName + '\\\\s*=[\\'\"]' + options.attrValue + '[\\'\"]').exec(S)\n        if (r) {\n            return r.index;\n        } else {\n            return -1;\n        }\n    }\n\n    var out = null;\n    if (options.attrValue !== undefined) {\n        options.attrName = options.attrName || 'id';\n        var out = [];\n\n        while ((pos = findElements()) !== -1) {\n            pos = S.lastIndexOf('<', pos);\n            if (pos !== -1) {\n                out.push(parseNode());\n            }\n            S = S.substr(pos);\n            pos = 0;\n        }\n    } else if (options.parseNode) {\n        out = parseNode()\n    } else {\n        out = parseChildren();\n    }\n\n    if (options.filter) {\n        out = tXml.filter(out, options.filter);\n    }\n\n    if (options.setPos) {\n        out.pos = pos;\n    }\n\n    return out;\n}\n\n/**\n * transform the DomObject to an object that is like the object of PHP`s simple_xmp_load_*() methods.\n * this format helps you to write that is more likely to keep your program working, even if there a small changes in the XML schema.\n * be aware, that it is not possible to reproduce the original xml from a simplified version, because the order of elements is not saved.\n * therefore your program will be more flexible and easier to read.\n *\n * @param {tNode[]} children the childrenList\n */\ntXml.simplify = function simplify(children) {\n    var out = {};\n    if (!children.length) {\n        return '';\n    }\n\n    if (children.length === 1 && typeof children[0] == 'string') {\n        return children[0];\n    }\n    // map each object\n    children.forEach(function(child) {\n        if (typeof child !== 'object') {\n            return;\n        }\n        if (!out[child.tagName])\n            out[child.tagName] = [];\n        var kids = tXml.simplify(child.children);\n        out[child.tagName].push(kids);\n        if (Object.keys(child.attributes).length) {\n            kids._attributes = child.attributes;\n        }\n    });\n\n    for (var i in out) {\n        if (out[i].length == 1) {\n            out[i] = out[i][0];\n        }\n    }\n\n    return out;\n};\n\n\n/**\n * similar to simplify, but lost less\n *\n * @param {tNode[]} children the childrenList\n */ \ntXml.simplifyLostLess = function simplify(children, parentAttributes={}) {\n    var out = {};\n    if (!children.length) {\n        return '';\n    }\n\n    if (children.length === 1 && typeof children[0] == 'string') {\n        return Object.keys(parentAttributes).length ? {\n            _attributes: parentAttributes,\n            value: children[0]\n        } :children[0];\n    }\n    // map each object\n    children.forEach(function(child) {\n        if (typeof child !== 'object') {\n            return;\n        }\n        if (!out[child.tagName])\n            out[child.tagName] = [];\n        var kids = tXml.simplifyLostLess(child.children||[], child.attributes);\n        out[child.tagName].push(kids);\n        if (Object.keys(child.attributes).length) {\n            kids._attributes = child.attributes;\n        }\n    });\n\n    return out;\n};\n\n/**\n * behaves the same way as Array.filter, if the filter method return true, the element is in the resultList\n * @params children{Array} the children of a node\n * @param f{function} the filter method\n */\ntXml.filter = function(children, f, dept=0,path='') {\n    var out = [];\n    children.forEach(function(child, i) {\n        if (typeof(child) === 'object' && f(child, i, dept, path)) out.push(child);\n        if (child.children) {\n            var kids = tXml.filter(child.children, f, dept+1, (path?path+'.':'')+i+'.'+child.tagName);\n            out = out.concat(kids);\n        }\n    });\n    return out;\n};\n\n/**\n * stringify a previously parsed string object.\n * this is useful,\n *  1. to remove whitespace\n * 2. to recreate xml data, with some changed data.\n * @param {tNode} O the object to Stringify\n */\ntXml.stringify = function stringify(O) {\n    var out = '';\n\n    function writeChildren(O) {\n        if (O)\n            for (var i = 0; i < O.length; i++) {\n                if (typeof O[i] == 'string') {\n                    out += O[i].trim();\n                } else {\n                    writeNode(O[i]);\n                }\n            }\n    }\n\n    function writeNode(N) {\n        out += \"<\" + N.tagName;\n        for (var i in N.attributes) {\n            if (N.attributes[i] === null) {\n                out += ' ' + i;\n            } else if (N.attributes[i].indexOf('\"') === -1) {\n                out += ' ' + i + '=\"' + N.attributes[i].trim() + '\"';\n            } else {\n                out += ' ' + i + \"='\" + N.attributes[i].trim() + \"'\";\n            }\n        }\n        out += '>';\n        writeChildren(N.children);\n        out += '</' + N.tagName + '>';\n    }\n    writeChildren(O);\n\n    return out;\n};\n\n\n/**\n * use this method to read the text content, of some node.\n * It is great if you have mixed content like:\n * this text has some <b>big</b> text and a <a href=''>link</a>\n * @return {string}\n */\ntXml.toContentString = function(tDom) {\n    if (Array.isArray(tDom)) {\n        var out = '';\n        tDom.forEach(function(e) {\n            out += ' ' + tXml.toContentString(e);\n            out = out.trim();\n        });\n        return out;\n    } else if (typeof tDom === 'object') {\n        return tXml.toContentString(tDom.children)\n    } else {\n        return ' ' + tDom;\n    }\n};\n\ntXml.getElementById = function(S, id, simplified) {\n    var out = tXml(S, {\n        attrValue: id\n    });\n    return simplified ? tXml.simplify(out) : out[0];\n};\n\ntXml.getElementsByClassName = function(S, classname, simplified) {\n    const out = tXml(S, {\n        attrName: 'class',\n        attrValue: '[a-zA-Z0-9- ]*' + classname + '[a-zA-Z0-9- ]*'\n    });\n    return simplified ? tXml.simplify(out) : out;\n};\n\ntXml.parseStream = function(stream, offset) {\n    if (typeof offset === 'string') {\n        offset = offset.length + 2;\n    }\n    if (typeof stream === 'string') {\n        var fs = require('fs');\n        stream = fs.createReadStream(stream, { start: offset });\n        offset = 0;\n    }\n\n    var position = offset;\n    var data = '';\n    stream.on('data', function(chunk) {\n        data += chunk;\n        var lastPos = 0;\n        do {\n            position = data.indexOf('<', position) + 1;\n            if(!position) {\n                position = lastPos;\n                return;\n            }\n            if (data[position + 1] === '/') {\n                position = position + 1;\n                lastPos = pos;\n                continue;\n            }\n            var res = tXml(data, { pos: position-1, parseNode: true, setPos: true });\n            position = res.pos;\n            if (position > (data.length - 1) || position < lastPos) {\n                data = data.slice(lastPos);\n                position = 0;\n                lastPos = 0;\n                return;\n            } else {\n                stream.emit('xml', res);\n                lastPos = position;\n            }\n        } while (1);\n    });\n    // stream.on('end', function() {\n    //     console.log('end')\n    // });\n    return stream;\n}\n\ntXml.transformStream = function (offset) {\n    // require through here, so it will not get added to webpack/browserify\n    const through2 = require('through2');\n    if (typeof offset === 'string') {\n        offset = offset.length + 2;\n    }\n\n    var position = offset || 0;\n    var data = '';\n    const stream = through2({ readableObjectMode: true }, function (chunk, enc, callback) {\n        data += chunk;\n        var lastPos = 0;\n        do {\n            position = data.indexOf('<', position) + 1;\n            if (!position) {\n                position = lastPos;\n                return callback();;\n            }\n            if (data[position + 1] === '/') {\n                position = position + 1;\n                lastPos = pos;\n                continue;\n            }\n            var res = tXml(data, { pos: position - 1, parseNode: true, setPos: true });\n            position = res.pos;\n            if (position > (data.length - 1) || position < lastPos) {\n                data = data.slice(lastPos);\n                position = 0;\n                return callback();;\n            } else {\n                this.push(res);\n                lastPos = position;\n            }\n        } while (1);\n        callback();\n    });\n\n    return stream;\n}\n\nif ('object' === typeof module) {\n    module.exports = tXml;\n    tXml.xml = tXml;\n}\n//console.clear();\n//console.log('here:',tXml.getElementById('<some><xml id=\"test\">dada</xml><that id=\"test\">value</that></some>','test'));\n//console.log('here:',tXml.getElementsByClassName('<some><xml id=\"test\" class=\"sdf test jsalf\">dada</xml><that id=\"test\">value</that></some>','test'));\n\n/*\nconsole.clear();\ntXml(d,'content');\n //some testCode\nvar s = document.body.innerHTML.toLowerCase();\nvar start = new Date().getTime();\nvar o = tXml(s,'content');\nvar end = new Date().getTime();\n//console.log(JSON.stringify(o,undefined,'\\t'));\nconsole.log(\"MILLISECONDS\",end-start);\nvar nodeCount=document.querySelectorAll('*').length;\nconsole.log('node count',nodeCount);\nconsole.log(\"speed:\",(1000/(end-start))*nodeCount,'Nodes / second')\n//console.log(JSON.stringify(tXml('<html><head><title>testPage</title></head><body><h1>TestPage</h1><p>this is a <b>test</b>page</p></body></html>'),undefined,'\\t'));\nvar p = new DOMParser();\nvar s2='<body>'+s+'</body>'\nvar start2= new Date().getTime();\nvar o2 = p.parseFromString(s2,'text/html').querySelector('#content')\nvar end2=new Date().getTime();\nconsole.log(\"MILLISECONDS\",end2-start2);\n// */\n"]}