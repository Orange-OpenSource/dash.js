{"version":3,"sources":["../../../../src/core/Settings.js"],"names":["Settings","instance","defaultSettings","debug","logLevel","Debug","LOG_LEVEL_WARNING","streaming","metricsMaxListDepth","abandonLoadTimeout","liveDelayFragmentCount","NaN","liveDelay","scheduleWhilePaused","fastSwitchEnabled","bufferPruningInterval","bufferToKeep","jumpGaps","jumpLargeGaps","smallGapLimit","stableBufferTime","bufferTimeAtTopQuality","bufferTimeAtTopQualityLongForm","longFormContentDurationThreshold","wallclockTimeUpdateInterval","lowLatencyEnabled","keepProtectionMediaKeys","useManifestDateHeaderTimeSource","useSuggestedPresentationDelay","useAppendWindow","manifestUpdateRetryInterval","liveCatchUpMinDrift","liveCatchUpMaxDrift","liveCatchUpPlaybackRate","liveCatchupLatencyThreshold","lastBitrateCachingInfo","enabled","ttl","lastMediaSettingsCachingInfo","cacheLoadThresholds","video","audio","retryIntervals","HTTPRequest","MPD_TYPE","XLINK_EXPANSION_TYPE","MEDIA_SEGMENT_TYPE","INIT_SEGMENT_TYPE","BITSTREAM_SWITCHING_SEGMENT_TYPE","INDEX_SEGMENT_TYPE","OTHER_TYPE","retryAttempts","abr","movingAverageMethod","Constants","MOVING_AVERAGE_SLIDING_WINDOW","ABRStrategy","ABR_STRATEGY_DYNAMIC","bandwidthSafetyFactor","useDefaultABRRules","useBufferOccupancyABR","useDeadTimeLatency","limitBitrateByPortal","usePixelRatioInLimitBitrateByPortal","maxBitrate","minBitrate","maxRepresentationRatio","initialBitrate","initialRepresentationRatio","autoSwitchBitrate","cmcd","sid","cid","did","settings","Utils","clone","mixinSettings","source","dest","path","n","hasOwnProperty","slice","get","update","settingsObj","reset","__dashjs_factory_name","factory","FactoryMaker","getSingletonFactory"],"mappings":"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","file":"Settings.js","sourcesContent":["/**\r\n * The copyright in this software is being made available under the BSD License,\r\n * included below. This software may be subject to other third party and contributor\r\n * rights, including patent rights, and no such rights are granted under this license.\r\n *\r\n * Copyright (c) 2013, Dash Industry Forum.\r\n * All rights reserved.\r\n *\r\n * Redistribution and use in source and binary forms, with or without modification,\r\n * are permitted provided that the following conditions are met:\r\n *  * Redistributions of source code must retain the above copyright notice, this\r\n *  list of conditions and the following disclaimer.\r\n *  * Redistributions in binary form must reproduce the above copyright notice,\r\n *  this list of conditions and the following disclaimer in the documentation and/or\r\n *  other materials provided with the distribution.\r\n *  * Neither the name of Dash Industry Forum nor the names of its\r\n *  contributors may be used to endorse or promote products derived from this software\r\n *  without specific prior written permission.\r\n *\r\n *  THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS AS IS AND ANY\r\n *  EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED\r\n *  WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED.\r\n *  IN NO EVENT SHALL THE COPYRIGHT HOLDER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT,\r\n *  INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT\r\n *  NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR\r\n *  PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY,\r\n *  WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE)\r\n *  ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE\r\n *  POSSIBILITY OF SUCH DAMAGE.\r\n */\r\nimport FactoryMaker from './FactoryMaker';\r\nimport Utils from './Utils.js';\r\nimport Debug from '../core/Debug';\r\nimport Constants from '../streaming/constants/Constants';\r\nimport {HTTPRequest} from '../streaming/vo/metrics/HTTPRequest';\r\n\r\n/** @module Settings\r\n * @description Define the configuration parameters of Dash.js MediaPlayer.\r\n * @see {@link module:Settings~PlayerSettings PlayerSettings} for further information about the supported configuration properties\r\n */\r\n\r\n\r\n/**\r\n * @typedef {Object} PlayerSettings\r\n * @property {module:Settings~DebugSettings} [debug] Debug related settings\r\n * @property {module:Settings~StreamingSettings} [streaming] Streaming related settings\r\n * @example\r\n *\r\n * // Full settings object\r\n * settings = {\r\n *      debug: {\r\n *          logLevel: Debug.LOG_LEVEL_WARNING\r\n *      },\r\n *      streaming: {\r\n *          metricsMaxListDepth: 1000,\r\n *          abandonLoadTimeout: 10000,\r\n *          liveDelayFragmentCount: NaN,\r\n *          liveDelay: null,\r\n *          scheduleWhilePaused: true,\r\n *          fastSwitchEnabled: false,\r\n *          bufferPruningInterval: 10,\r\n *          bufferToKeep: 20,\r\n *          jumpGaps: true,\r\n *          jumpLargeGaps: true,\r\n *          smallGapLimit: 1.5,\r\n *          stableBufferTime: 12,\r\n *          bufferTimeAtTopQuality: 30,\r\n *          bufferTimeAtTopQualityLongForm: 60,\r\n *          longFormContentDurationThreshold: 600,\r\n *          wallclockTimeUpdateInterval: 50,\r\n *          lowLatencyEnabled: false,\r\n *          keepProtectionMediaKeys: false,\r\n *          useManifestDateHeaderTimeSource: true,\r\n *          useSuggestedPresentationDelay: true,\r\n *          useAppendWindow: true,\r\n *          manifestUpdateRetryInterval: 100,\r\n *          liveCatchUpMinDrift: 0.02,\r\n *          liveCatchUpMaxDrift: 0,\r\n *          liveCatchUpPlaybackRate: 0.5,\r\n *          lastBitrateCachingInfo: { enabled: true, ttl: 360000 },\r\n *          lastMediaSettingsCachingInfo: { enabled: true, ttl: 360000 },\r\n *          cacheLoadThresholds: { video: 50, audio: 5 },\r\n *          retryIntervals: {\r\n *              MPD: 500,\r\n *              XLinkExpansion: 500,\r\n *              InitializationSegment: 1000,\r\n *              IndexSegment: 1000,\r\n *              MediaSegment: 1000,\r\n *              BitstreamSwitchingSegment: 1000,\r\n *              other: 1000,\r\n *              lowLatencyReductionFactor: 10\r\n *          },\r\n *          retryAttempts: {\r\n *              MPD: 3,\r\n *              XLinkExpansion: 1,\r\n *              InitializationSegment: 3,\r\n *              IndexSegment: 3,\r\n *              MediaSegment: 3,\r\n *              BitstreamSwitchingSegment: 3,\r\n *              other: 3,\r\n *              lowLatencyMultiplyFactor: 5\r\n *          },\r\n *          abr: {\r\n *              movingAverageMethod: Constants.MOVING_AVERAGE_SLIDING_WINDOW,\r\n *              ABRStrategy: Constants.ABR_STRATEGY_DYNAMIC,\r\n *              bandwidthSafetyFactor: 0.9,\r\n *              useDefaultABRRules: true,\r\n *              useBufferOccupancyABR: false,\r\n *              useDeadTimeLatency: true,\r\n *              limitBitrateByPortal: false,\r\n *              usePixelRatioInLimitBitrateByPortal: false,\r\n *              maxBitrate: { audio: -1, video: -1 },\r\n *              minBitrate: { audio: -1, video: -1 },\r\n *              maxRepresentationRatio: { audio: 1, video: 1 },\r\n *              initialBitrate: { audio: -1, video: -1 },\r\n *              initialRepresentationRatio: { audio: -1, video: -1 },\r\n *              autoSwitchBitrate: { audio: true, video: true }\r\n *          },\r\n *          cmcd: {\r\n *              enabled: false,\r\n *              sid: null,\r\n *              cid: null,\r\n *              did: null\r\n *          }\r\n *      }\r\n * }\r\n */\r\n\r\n\r\n/**\r\n * @typedef {Object} DebugSettings\r\n * @property {number} [logLevel=dashjs.Debug.LOG_LEVEL_WARNING]\r\n * Sets up the log level. The levels are cumulative. For example, if you set the log level\r\n * to dashjs.Debug.LOG_LEVEL_WARNING all warnings, errors and fatals will be logged. Possible values.\r\n *\r\n * <ul>\r\n * <li>dashjs.Debug.LOG_LEVEL_NONE<br/>\r\n * No message is written in the browser console.\r\n *\r\n * <li>dashjs.Debug.LOG_LEVEL_FATAL<br/>\r\n * Log fatal errors. An error is considered fatal when it causes playback to fail completely.\r\n *\r\n * <li>dashjs.Debug.LOG_LEVEL_ERROR<br/>\r\n * Log error messages.\r\n *\r\n * <li>dashjs.Debug.LOG_LEVEL_WARNING<br/>\r\n * Log warning messages.\r\n *\r\n * <li>dashjs.Debug.LOG_LEVEL_INFO<br/>\r\n * Log info messages.\r\n *\r\n * <li>dashjs.Debug.LOG_LEVEL_DEBUG<br/>\r\n * Log debug messages.\r\n * </ul>\r\n */\r\n\r\n/**\r\n * @typedef {Object} AbrSettings\r\n * @property {string} [movingAverageMethod=\"slidingWindow\"]\r\n * Sets the moving average method used for smoothing throughput estimates. Valid methods are\r\n * \"slidingWindow\" and \"ewma\". The call has no effect if an invalid method is passed.\r\n *\r\n * The sliding window moving average method computes the average throughput using the last four segments downloaded.\r\n * If the stream is live (as opposed to VOD), then only the last three segments are used.\r\n * If wide variations in throughput are detected, the number of segments can be dynamically increased to avoid oscillations.\r\n *\r\n * The exponentially weighted moving average (EWMA) method computes the average using exponential smoothing.\r\n * Two separate estimates are maintained, a fast one with a three-second half life and a slow one with an eight-second half life.\r\n * The throughput estimate at any time is the minimum of the fast and slow estimates.\r\n * This allows a fast reaction to a bandwidth drop and prevents oscillations on bandwidth spikes.\r\n * @property {string} [ABRStrategy=\"abrDynamic\"] Returns the current ABR strategy being used: \"abrDynamic\", \"abrBola\" or \"abrThroughput\".\r\n * @property {number} [bandwidthSafetyFactor=0.9]\r\n * Standard ABR throughput rules multiply the throughput by this value. It should be between 0 and 1,\r\n * with lower values giving less rebuffering (but also lower quality).\r\n * @property {boolean} [useDefaultABRRules=true] Should the default ABR rules be used, or the custom ones added.\r\n * @property {boolean} [useBufferOccupancyABR=false] Whether to use the BOLA abr rule.\r\n * @property {boolean} [useDeadTimeLatency=true]\r\n * If true, only the download portion will be considered part of the download bitrate\r\n * and latency will be regarded as static. If false, the reciprocal of the whole\r\n * transfer time will be used.\r\n * @property {boolean} [limitBitrateByPortal=false] If true, the size of the video portal will limit the max chosen video resolution.\r\n * @property {boolean} [usePixelRatioInLimitBitrateByPortal=false]\r\n * Sets whether to take into account the device's pixel ratio when defining the portal dimensions.\r\n * Useful on, for example, retina displays.\r\n * @property {module:Settings~AudioVideoSettings} [maxBitrate={audio: -1, video: -1}] The maximum bitrate that the ABR algorithms will choose. Use NaN for no limit.\r\n * @property {module:Settings~AudioVideoSettings} [minBitrate={audio: -1, video: -1}] The minimum bitrate that the ABR algorithms will choose. Use NaN for no limit.\r\n * @property {module:Settings~AudioVideoSettings} [maxRepresentationRatio={audio: 1, video: 1}]\r\n * When switching multi-bitrate content (auto or manual mode) this property specifies the maximum representation allowed,\r\n * as a proportion of the size of the representation set.\r\n *\r\n * You can set or remove this cap at anytime before or during playback. To clear this setting you set the value to 1.\r\n *\r\n * If both this and maxAllowedBitrate are defined, maxAllowedBitrate is evaluated first, then maxAllowedRepresentation,\r\n * i.e. the lowest value from executing these rules is used.\r\n *\r\n * This feature is typically used to reserve higher representations for playback only when connected over a fast connection.\r\n * @property {module:Settings~AudioVideoSettings} [initialBitrate={audio: -1, video: -1}] Explicitly set the starting bitrate for audio or video\r\n * @property {module:Settings~AudioVideoSettings} [initialRepresentationRatio={audio: -1, video: -1}] Explicitly set the initial representation ratio. If initalBitrate is specified, this is ignored.\r\n * @property {module:Settings~AudioVideoSettings} [autoSwitchBitrate={audio: true, video: true}] Indicates whether the player should enable ABR algorithms to switch the bitrate.\r\n */\r\n\r\n/**\r\n * @typedef {Object} StreamingSettings\r\n * @property {number} [metricsMaxListDepth=1000] Maximum list depth of metrics.\r\n * @property {number} [abandonLoadTimeout=10000]\r\n * A timeout value in seconds, which during the ABRController will block switch-up events.\r\n * This will only take effect after an abandoned fragment event occurs.\r\n * @property {number} [liveDelayFragmentCount=NaN]\r\n * Changing this value will lower or increase live stream latency.  The detected segment duration will be multiplied by this value\r\n * to define a time in seconds to delay a live stream from the live edge. Lowering this value will lower latency but may decrease\r\n * the player's ability to build a stable buffer.\r\n * @property {number} [liveDelay]\r\n * <p>Equivalent in seconds of setLiveDelayFragmentCount</p>\r\n * <p>Lowering this value will lower latency but may decrease the player's ability to build a stable buffer.</p>\r\n * <p>This value should be less than the manifest duration by a couple of segment durations to avoid playback issues</p>\r\n * <p>If set, this parameter will take precedence over setLiveDelayFragmentCount and manifest info</p>\r\n * @property {boolean} [scheduleWhilePaused=true]\r\n * Set to true if you would like dash.js to keep downloading fragments in the background\r\n * when the video element is paused.\r\n * @property {boolean} [fastSwitchEnabled=false]\r\n * When enabled, after an ABR up-switch in quality, instead of requesting and appending the next fragment\r\n * at the end of the current buffer range it is requested and appended closer to the current time\r\n * When enabled, The maximum time to render a higher quality is current time + (1.5 * fragment duration).\r\n *\r\n * Note, When ABR down-switch is detected, we appended the lower quality at the end of the buffer range to preserve the\r\n * higher quality media for as long as possible.\r\n *\r\n * If enabled, it should be noted there are a few cases when the client will not replace inside buffer range but rather\r\n * just append at the end.  1. When the buffer level is less than one fragment duration 2.  The client\r\n * is in an Abandonment State due to recent fragment abandonment event.\r\n *\r\n * Known issues:\r\n * 1. In IE11 with auto switching off, if a user switches to a quality they can not download in time the\r\n * fragment may be appended in the same range as the playhead or even in the past, in IE11 it may cause a stutter\r\n * or stall in playback.\r\n * @property {number} [bufferPruningInterval=10] The interval of pruning buffer in sconds.\r\n * @property {number} [bufferToKeep=20]\r\n * This value influences the buffer pruning logic.\r\n * Allows you to modify the buffer that is kept in source buffer in seconds.\r\n *  0|-----------bufferToPrune-----------|-----bufferToKeep-----|currentTime|\r\n * @property {boolean} [jumpGaps=true] Sets whether player should jump small gaps (discontinuities) in the buffer.\r\n * @property {boolean} [jumpLargeGaps=true] Sets whether player should jump large gaps (discontinuities) in the buffer.\r\n * @property {number} [smallGapLimit=1.8] Time in seconds for a gap to be considered small.\r\n * @property {number} [stableBufferTime=12]\r\n * The time that the internal buffer target will be set to post startup/seeks (NOT top quality).\r\n *\r\n * When the time is set higher than the default you will have to wait longer\r\n * to see automatic bitrate switches but will have a larger buffer which\r\n * will increase stability.\r\n * @property {number} [bufferTimeAtTopQuality=30]\r\n * The time that the internal buffer target will be set to once playing the top quality.\r\n * If there are multiple bitrates in your adaptation, and the media is playing at the highest\r\n * bitrate, then we try to build a larger buffer at the top quality to increase stability\r\n * and to maintain media quality.\r\n * @property {number} [bufferTimeAtTopQualityLongForm=60] The time that the internal buffer target will be set to once playing the top quality for long form content.\r\n * @property {number} [longFormContentDurationThreshold=600]\r\n * The threshold which defines if the media is considered long form content.\r\n * This will directly affect the buffer targets when playing back at the top quality.\r\n * @property {number} [wallclockTimeUpdateInterval=50] How frequently the wallclockTimeUpdated internal event is triggered (in milliseconds).\r\n * @property {boolean} [lowLatencyEnabled=false] Enable or disable low latency mode\r\n * @property {boolean} [keepProtectionMediaKeys=false]\r\n * Set the value for the ProtectionController and MediaKeys life cycle. If true, the\r\n * ProtectionController and then created MediaKeys and MediaKeySessions will be preserved during\r\n * the MediaPlayer lifetime.\r\n * @property {boolean} [useManifestDateHeaderTimeSource=true]\r\n * <p>Allows you to enable the use of the Date Header, if exposed with CORS, as a timing source for live edge detection. The\r\n * use of the date header will happen only after the other timing source that take precedence fail or are omitted as described.\r\n * @property {boolean} [useSuggestedPresentationDelay=true]\r\n * <p>Set to true if you would like to override the default live delay and honor the SuggestedPresentationDelay attribute in by the manifest.</p>\r\n * @property {boolean} [useAppendWindow=true]\r\n * Specifies if the appendWindow attributes of the MSE SourceBuffers should be set according to content duration from manifest.\r\n * @property {number} [manifestUpdateRetryInterval=100]\r\n * For live streams, set the interval-frequency in milliseconds at which\r\n * dash.js will check if the current manifest is still processed before\r\n * downloading the next manifest once the minimumUpdatePeriod time has\r\n * @property {number} [liveCatchUpMinDrift=0.02]\r\n * Use this method to set the minimum latency deviation allowed before activating catch-up mechanism. In low latency mode,\r\n * when the difference between the measured latency and the target one,\r\n * as an absolute number, is higher than the one sets with this method, then dash.js increases/decreases\r\n * playback rate until target latency is reached.\r\n *\r\n * LowLatencyMinDrift should be provided in seconds, and it uses values between 0.0 and 0.5.\r\n *\r\n * Note: Catch-up mechanism is only applied when playing low latency live streams.\r\n * @property {number} [liveCatchUpMaxDrift=0]\r\n * Use this method to set the maximum latency deviation allowed before dash.js to do a seeking to live position. In low latency mode,\r\n * when the difference between the measured latency and the target one,\r\n * as an absolute number, is higher than the one sets with this method, then dash.js does a seek to live edge position minus\r\n * the target live delay.\r\n *\r\n * LowLatencyMaxDriftBeforeSeeking should be provided in seconds. If 0, then seeking operations won't be used for\r\n * fixing latency deviations.\r\n *\r\n * Note: Catch-up mechanism is only applied when playing low latency live streams.\r\n * @property {number} [liveCatchUpPlaybackRate=0.5]\r\n * Use this parameter to set the maximum catch up rate, as a percentage, for low latency live streams. In low latency mode,\r\n * when measured latency is higher/lower than the target one,\r\n * dash.js increases/decreases playback rate respectively up to (+/-) the percentage defined with this method until target is reached.\r\n *\r\n * Valid values for catch up rate are in range 0-0.5 (0-50%). Set it to 0 to turn off live catch up feature.\r\n *\r\n * Note: Catch-up mechanism is only applied when playing low latency live streams.\r\n * @property {number} [liveCatchupLatencyThreshold=NaN]\r\n * Use this parameter to set the maximum threshold for which live catch up is applied. For instance, if this value is set to 8 seconds,\r\n * then live catchup is only applied if the current live latency is equal or below 8 seconds. The reason behind this parameter is to avoid an increase\r\n * of the playback rate if the user seeks within the DVR window.\r\n *\r\n * If no value is specified this will be twice the maximum live delay. The maximum live delay is either specified in the manifest as part of a ServiceDescriptor or calculated the following:\r\n * maximumLiveDelay = targetDelay + liveCatchupMinDrift\r\n *\r\n * Note: Catch-up mechanism is only applied when playing low latency live streams.\r\n * @property {module:Settings~CachingInfoSettings} [lastBitrateCachingInfo={enabled: true, ttl: 360000}]\r\n * Set to false if you would like to disable the last known bit rate from being stored during playback and used\r\n * to set the initial bit rate for subsequent playback within the expiration window.\r\n *\r\n * The default expiration is one hour, defined in milliseconds. If expired, the default initial bit rate (closest to 1000 kbps) will be used\r\n * for that session and a new bit rate will be stored during that session.\r\n * @property {module:Settings~CachingInfoSettings} [lastMediaSettingsCachingInfo={enabled: true, ttl: 360000}]\r\n * Set to false if you would like to disable the last known lang for audio (or camera angle for video) from being stored during playback and used\r\n * to set the initial settings for subsequent playback within the expiration window.\r\n *\r\n * The default expiration is one hour, defined in milliseconds. If expired, the default settings will be used\r\n * for that session and a new settings will be stored during that session.\r\n * @property {module:Settings~AudioVideoSettings} [cacheLoadThresholds={video: 50, audio: 5}]\r\n * For a given media type, the threshold which defines if the response to a fragment\r\n * request is coming from browser cache or not.\r\n * @property {module:Settings~RequestTypeSettings} [retryIntervals] Time in milliseconds of which to reload a failed file load attempt. For low latency mode these values are divided by lowLatencyReductionFactor.\r\n * @property {module:Settings~RequestTypeSettings} [retryAttempts] Total number of retry attempts that will occur on a file load before it fails. For low latency mode these values are multiplied by lowLatencyMultiplyFactor.\r\n * @property {module:Settings~AbrSettings} abr Adaptive Bitrate algorithm related settings.\r\n * @property {module:Settings~CmcdSettings} cmcd  Settings related to Common Media Client Data reporting.\r\n */\r\n\r\n/**\r\n * @typedef {Object} CachingInfoSettings\r\n * @property {boolean} [enable] Enable or disable the caching feature.\r\n * @property {number} [ttl] Time to live. A value defined in milliseconds representing how log to cache the settings for.\r\n */\r\n\r\n/**\r\n * @typedef {Object} module:Settings~AudioVideoSettings\r\n * @property {number|boolean} [audio] Configuration for audio media type of tracks.\r\n * @property {number|boolean} [video] Configuration for video media type of tracks.\r\n */\r\n\r\n/**\r\n * @typedef {Object} RequestTypeSettings\r\n * @property {number} [MPD] Manifest type of requests\r\n * @property {number} [XLinkExpansion] XLink expansion type of requests\r\n * @property {number} [InitializationSegment] Request to retrieve an initialization segment\r\n * @property {number} [IndexSegment] Request to retrieve an index segment (SegmentBase)\r\n * @property {number} [MediaSegment] Request to retrieve a media segment (video/audio/image/text chunk)\r\n * @property {number} [BitstreamSwitchingSegment] Bitrate stream switching type of request\r\n * @property {number} [other] Other type of request\r\n *\r\n */\r\n\r\n/**\r\n * @typedef {Object} module:Settings~CmcdSettings\r\n * @property {boolean} [enable=false] Enable or disable the CMCD reporting.\r\n * @property {string} [sid] GUID identifying the current playback session. Should be in UUID format. If not specified a UUID will be automatically generated.\r\n * @property {string} [cid] A unique string to identify the current content. If not specified it will be a hash of the MPD url.\r\n * @property {string} [did=dash.js-cmcd-default-id] A unique string identifying the current device.\r\n */\r\n\r\n\r\n/**\r\n * @class\r\n * @ignore\r\n */\r\nfunction Settings() {\r\n    let instance;\r\n\r\n    /**\r\n     * @const {PlayerSettings} defaultSettings\r\n     * @ignore\r\n     */\r\n    const defaultSettings = {\r\n        debug: {\r\n            logLevel: Debug.LOG_LEVEL_WARNING\r\n        },\r\n        streaming: {\r\n            metricsMaxListDepth: 1000,\r\n            abandonLoadTimeout: 10000,\r\n            liveDelayFragmentCount: NaN,\r\n            liveDelay: null,\r\n            scheduleWhilePaused: true,\r\n            fastSwitchEnabled: false,\r\n            bufferPruningInterval: 10,\r\n            bufferToKeep: 20,\r\n            jumpGaps: true,\r\n            jumpLargeGaps: true,\r\n            smallGapLimit: 1.5,\r\n            stableBufferTime: 12,\r\n            bufferTimeAtTopQuality: 30,\r\n            bufferTimeAtTopQualityLongForm: 60,\r\n            longFormContentDurationThreshold: 600,\r\n            wallclockTimeUpdateInterval: 50,\r\n            lowLatencyEnabled: false,\r\n            keepProtectionMediaKeys: false,\r\n            useManifestDateHeaderTimeSource: true,\r\n            useSuggestedPresentationDelay: true,\r\n            useAppendWindow: true,\r\n            manifestUpdateRetryInterval: 100,\r\n            liveCatchUpMinDrift: 0.02,\r\n            liveCatchUpMaxDrift: 0,\r\n            liveCatchUpPlaybackRate: 0.5,\r\n            liveCatchupLatencyThreshold: NaN,\r\n            lastBitrateCachingInfo: {enabled: true, ttl: 360000},\r\n            lastMediaSettingsCachingInfo: {enabled: true, ttl: 360000},\r\n            cacheLoadThresholds: {video: 50, audio: 5},\r\n            retryIntervals: {\r\n                [HTTPRequest.MPD_TYPE]: 500,\r\n                [HTTPRequest.XLINK_EXPANSION_TYPE]: 500,\r\n                [HTTPRequest.MEDIA_SEGMENT_TYPE]: 1000,\r\n                [HTTPRequest.INIT_SEGMENT_TYPE]: 1000,\r\n                [HTTPRequest.BITSTREAM_SWITCHING_SEGMENT_TYPE]: 1000,\r\n                [HTTPRequest.INDEX_SEGMENT_TYPE]: 1000,\r\n                [HTTPRequest.OTHER_TYPE]: 1000,\r\n                lowLatencyReductionFactor: 10\r\n            },\r\n            retryAttempts: {\r\n                [HTTPRequest.MPD_TYPE]: 3,\r\n                [HTTPRequest.XLINK_EXPANSION_TYPE]: 1,\r\n                [HTTPRequest.MEDIA_SEGMENT_TYPE]: 3,\r\n                [HTTPRequest.INIT_SEGMENT_TYPE]: 3,\r\n                [HTTPRequest.BITSTREAM_SWITCHING_SEGMENT_TYPE]: 3,\r\n                [HTTPRequest.INDEX_SEGMENT_TYPE]: 3,\r\n                [HTTPRequest.OTHER_TYPE]: 3,\r\n                lowLatencyMultiplyFactor: 5\r\n            },\r\n            abr: {\r\n                movingAverageMethod: Constants.MOVING_AVERAGE_SLIDING_WINDOW,\r\n                ABRStrategy: Constants.ABR_STRATEGY_DYNAMIC,\r\n                bandwidthSafetyFactor: 0.9,\r\n                useDefaultABRRules: true,\r\n                useBufferOccupancyABR: false,\r\n                useDeadTimeLatency: true,\r\n                limitBitrateByPortal: false,\r\n                usePixelRatioInLimitBitrateByPortal: false,\r\n                maxBitrate: {audio: -1, video: -1},\r\n                minBitrate: {audio: -1, video: -1},\r\n                maxRepresentationRatio: {audio: 1, video: 1},\r\n                initialBitrate: {audio: -1, video: -1},\r\n                initialRepresentationRatio: {audio: -1, video: -1},\r\n                autoSwitchBitrate: {audio: true, video: true}\r\n            },\r\n            cmcd: {\r\n                enabled: false,\r\n                sid: null,\r\n                cid: null,\r\n                did: null\r\n            }\r\n        }\r\n    };\r\n\r\n    let settings = Utils.clone(defaultSettings);\r\n\r\n    //Merge in the settings. If something exists in the new config that doesn't match the schema of the default config,\r\n    //regard it as an error and log it.\r\n    function mixinSettings(source, dest, path) {\r\n        for (let n in source) {\r\n            if (source.hasOwnProperty(n)) {\r\n                if (dest.hasOwnProperty(n)) {\r\n                    if (typeof source[n] === 'object' && source[n] !== null) {\r\n                        mixinSettings(source[n], dest[n], path.slice() + n + '.');\r\n                    } else {\r\n                        dest[n] = Utils.clone(source[n]);\r\n                    }\r\n                }\r\n            }\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Return the settings object. Don't copy/store this object, you won't get updates.\r\n     * @func\r\n     * @instance\r\n     */\r\n    function get() {\r\n        return settings;\r\n    }\r\n\r\n    /**\r\n     * @func\r\n     * @instance\r\n     * @param {object} settingsObj - This should be a partial object of the Settings.Schema type. That is, fields defined should match the path (e.g.\r\n     * settingsObj.streaming.abr.autoSwitchBitrate.audio -> defaultSettings.streaming.abr.autoSwitchBitrate.audio). Where an element's path does\r\n     * not match it is ignored, and a warning is logged.\r\n     *\r\n     * Use to change the settings object. Any new values defined will overwrite the settings and anything undefined will not change.\r\n     * Implementers of new settings should add it in an approriate namespace to the defaultSettings object and give it a default value (that is not undefined).\r\n     *\r\n     */\r\n    function update(settingsObj) {\r\n        if (typeof settingsObj === 'object') {\r\n            mixinSettings(settingsObj, settings, '');\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Resets the settings object. Everything is set to its default value.\r\n     * @func\r\n     * @instance\r\n     *\r\n     */\r\n    function reset() {\r\n        settings = Utils.clone(defaultSettings);\r\n    }\r\n\r\n    instance = {\r\n        get: get,\r\n        update: update,\r\n        reset: reset\r\n    };\r\n\r\n    return instance;\r\n}\r\n\r\n\r\nSettings.__dashjs_factory_name = 'Settings';\r\nlet factory = FactoryMaker.getSingletonFactory(Settings);\r\nexport default factory;\r\n"]}